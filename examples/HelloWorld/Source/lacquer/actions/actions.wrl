module actions;

public use state.Stateful;

/// An action is simply an interactive activity that should
/// be carried out on the client, rather than the server.
public interface Actionable {
    public function toAction() -> Action;
}


public model Action implements Display {
    public var kind: String;
    public var argument: ?String;
    public var target: ?String;

    new(kind: String, argument?: String, target?: String){
        this.kind = kind;
        this.argument = argument;
        this.target = target;
    }

    public function toStr() -> String {
        template := '{"kind":%,"argument":"%","target":"%"}';
        return String.fmt(template)
            .add(this.kind)
            .add(this.argument)
            .add(this.target)
            .finish()
    }
}

/// Creates a state update action that increments the state value with a specified name.
/// ### Usage
/// ```
/// use tangent.actions;
/// 
/// button := Button();
/// button.toView().onClick(actions.increment("counter.value"));
/// ```
public function increment(name: String, count?: Int32) -> Action {
    Action("INCREMENT", some(count.unwrapOr(1).toStr()), some(name))
}

public function decrement(name: String) -> Action {
    todo()
}